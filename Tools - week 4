
@author: Yaron
"""

import pandas
import numpy
import scipy.stats
import seaborn
import matplotlib.pyplot as plt

data = pandas.read_csv('gapminder.csv', low_memory=False)

data['alcconsumption'] = data['alcconsumption'].convert_objects(convert_numeric=True)
data['incomeperperson'] = data['incomeperperson'].convert_objects(convert_numeric=True)
data['armedforcesrate'] = data['armedforcesrate'].convert_objects(convert_numeric=True)
data['incomeperperson']=data['incomeperperson'].replace(' ', numpy.nan)

data_clean=data.dropna()

def incomegrp (row):
   if row['incomeperperson'] <= 744.239:
      return 1
   elif row['incomeperperson'] <= 9425.326 :
      return 2
   elif row['incomeperperson'] > 9425.326:
      return 3
   
data_clean['incomegrp'] = data_clean.apply (lambda row: incomegrp (row),axis=1)

chk1 = data_clean['incomegrp'].value_counts(sort=False, dropna=False)
print(chk1)

sub1=data_clean[(data_clean['incomegrp']== 1)]
sub2=data_clean[(data_clean['incomegrp']== 2)]
sub3=data_clean[(data_clean['incomegrp']== 3)]

print ('association between armedforcesrate and alcconsumption for LOW income countries')
print (scipy.stats.pearsonr(sub1['armedforcesrate'], sub1['alcconsumption']))
print ('       ')
print ('association between armedforcesrate and alcconsumption for MIDDLE income countries')
print (scipy.stats.pearsonr(sub2['armedforcesrate'], sub2['alcconsumption']))
print ('       ')
print ('association between armedforcesrate and alcconsumption for HIGH income countries')
print (scipy.stats.pearsonr(sub3['armedforcesrate'], sub3['alcconsumption']))
#%%
scat1 = seaborn.regplot(x="armedforcesrate", y="alcconsumption", data=sub1)
plt.xlabel('Armed Forces Rate')
plt.ylabel('Alcohol Cunsmption')
plt.title('Scatterplot for the Association Between Armed Forces Rate and Alcohol Consumption for LOW income countries')
print (scat1)
#%%
scat2 = seaborn.regplot(x="armedforcesrate", y="alcconsumption", data=sub2)
plt.xlabel('Armed Forces Rate')
plt.ylabel('Alcohol Cunsmption')
plt.title('Scatterplot for the Association Between Armed Forces Rate and Alcohol Cunsmption for MIDDLE income countries')
print (scat2)
#%%
scat3 = seaborn.regplot(x="armedforcesrate", y="alcconsumption", data=sub3)
plt.xlabel('Armed Forces Rate')
plt.ylabel('Alcohol Consumption')
plt.title('Scatterplot for the Association Between Armed Forces Rate and Alcohol Cusmption for HIGH income countries')
print (scat3)
